<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; connect-src 'self' ws: wss: http: https:;">
  <title>Work Messenger</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <!-- 로딩 스크린 -->
  <div class="loading-screen" id="loading-screen">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <h2>Work Messenger</h2>
      <p>로딩 중...</p>
    </div>
  </div>

  <!-- 로그인/회원가입 화면 -->
  <div class="auth-screen" id="auth-screen" style="display: none;">
    <div class="auth-container">
      <div class="auth-header">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" class="auth-logo">
          <rect x="2" y="4" width="20" height="16" rx="3" stroke="currentColor" stroke-width="1.5" />
          <path d="M6 9h12M6 13h8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
        </svg>
        <h1>Work Messenger</h1>
        <p>업무용 메신저 - 집중력을 높이는 깔끔한 디자인</p>
      </div>

      <!-- 로그인 폼 -->
      <div class="auth-form" id="login-form">
        <h2>로그인</h2>
        <form id="login-form-element">
          <div class="form-group">
            <label for="login-username">아이디</label>
            <input type="text" id="login-username" placeholder="아이디를 입력하세요" required autocomplete="username">
          </div>
          <div class="form-group">
            <label for="login-password">비밀번호</label>
            <input type="password" id="login-password" placeholder="비밀번호를 입력하세요" required
              autocomplete="current-password">
          </div>
          <div class="form-group" id="2fa-code-group" style="display: none;">
            <label for="login-2fa-code">2단계 인증 코드</label>
            <input type="text" id="login-2fa-code" placeholder="6자리 코드 입력" maxlength="6" pattern="[0-9]{6}"
              autocomplete="one-time-code">
            <small class="form-hint">인증 앱에서 6자리 코드를 입력하세요</small>
          </div>
          <div class="form-options">
            <label class="checkbox-label">
              <input type="checkbox" id="remember-me">
              <span>로그인 상태 유지</span>
            </label>
            <a href="#" id="forgot-password-link" class="forgot-password-link">비밀번호를 잊으셨나요?</a>
          </div>
          <button type="submit" class="auth-btn primary">로그인</button>
          <div class="auth-divider">
            <span>또는</span>
          </div>
          <button type="button" class="auth-btn secondary" id="show-signup">회원가입</button>
        </form>
      </div>

      <!-- 회원가입 폼 -->
      <div class="auth-form" id="signup-form" style="display: none;">
        <h2>회원가입</h2>
        <form id="signup-form-element">
          <div class="form-group">
            <label for="signup-username">아이디</label>
            <input type="text" id="signup-username" placeholder="아이디를 입력하세요" required autocomplete="username">
          </div>
          <div class="form-group">
            <label for="signup-name">이름</label>
            <input type="text" id="signup-name" placeholder="이름을 입력하세요" required autocomplete="name">
          </div>
          <div class="form-group">
            <label for="signup-email">이메일</label>
            <input type="email" id="signup-email" placeholder="이메일을 입력하세요" required autocomplete="email">
          </div>
          <div class="form-group">
            <label for="signup-password">비밀번호</label>
            <input type="password" id="signup-password" placeholder="비밀번호를 입력하세요" required autocomplete="new-password">
          </div>
          <div class="form-group">
            <label for="signup-password-confirm">비밀번호 확인</label>
            <input type="password" id="signup-password-confirm" placeholder="비밀번호를 다시 입력하세요" required
              autocomplete="new-password">
          </div>
          <button type="submit" class="auth-btn primary">회원가입</button>
          <div class="auth-divider">
            <span>또는</span>
          </div>
          <button type="button" class="auth-btn secondary" id="show-login">로그인으로 돌아가기</button>
        </form>
      </div>
    </div>
  </div>

  <!-- 커스텀 타이틀바 (항상 표시) -->
  <header class="titlebar" id="titlebar">
    <div class="titlebar-drag">
      <div class="app-logo">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <rect x="2" y="4" width="20" height="16" rx="3" stroke="currentColor" stroke-width="1.5" />
          <path d="M6 9h12M6 13h8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
        </svg>
        <span>Work Messenger</span>
      </div>
    </div>
    <div class="titlebar-controls">
      <button class="titlebar-btn" id="btn-minimize" title="최소화">
        <svg width="12" height="12" viewBox="0 0 12 12">
          <rect y="5" width="12" height="2" fill="currentColor" />
        </svg>
      </button>
      <button class="titlebar-btn" id="btn-maximize" title="최대화">
        <svg width="12" height="12" viewBox="0 0 12 12">
          <rect x="1" y="1" width="10" height="10" stroke="currentColor" stroke-width="1.5" fill="none" />
        </svg>
      </button>
      <button class="titlebar-btn btn-close" id="btn-close" title="닫기">
        <svg width="12" height="12" viewBox="0 0 12 12">
          <path d="M1 1l10 10M11 1L1 11" stroke="currentColor" stroke-width="1.5" />
        </svg>
      </button>
    </div>
  </header>

  <div id="app">

    <!-- 메인 컨테이너 -->
    <main class="main-container">
      <!-- 사이드바 - 서버 목록 -->
      <aside class="sidebar">
        <div class="server-home" title="홈" id="btn-my-page">
          <div class="user-avatar" id="user-avatar">
            <span>U</span>
          </div>
          <div class="user-status online" id="user-status-indicator"></div>
        </div>

        <button class="server-dm" id="btn-dm" title="다이렉트 메시지">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke="currentColor"
              stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>

        <button class="server-dm" id="btn-saved-messages" title="저장한 메시지">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>

        <div class="servers-divider"></div>

        <div class="servers-list" id="servers-list">
          <!-- 서버 아이템들이 동적으로 추가됨 -->
        </div>

        <button class="server-add" id="btn-add-server" title="서버 추가">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>

        <div class="sidebar-bottom">
          <button class="nav-item" id="btn-calendar" title="일정관리">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="1.5" />
              <path d="M3 10h18M8 2v4M16 2v4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            </svg>
          </button>
          <button class="nav-item" id="theme-toggle-btn" title="테마 변경">
            🌙
          </button>
          <button class="nav-item" id="btn-settings" title="설정">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="1.5" />
              <path
                d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"
                stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            </svg>
          </button>
        </div>
      </aside>

      <!-- 채널 목록 -->
      <section class="chat-list">
        <div class="chat-list-header">
          <h2 id="server-name">서버 선택</h2>
          <div class="header-actions">
            <button class="icon-btn" id="btn-global-search" title="전체 검색 (Ctrl+K)">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2" />
                <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              </svg>
            </button>
            <button class="icon-btn" id="btn-mentions" title="내 멘션">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                <path d="M12 8v4M12 16h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              </svg>
            </button>
            <button class="icon-btn" id="btn-new-category" title="카테고리 추가" style="display: none;">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M3 7h18M3 12h18M3 17h18" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              </svg>
            </button>
            <button class="icon-btn" id="btn-new-channel" title="채널 추가" style="display: none;">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              </svg>
            </button>
          </div>
        </div>

        <div class="search-box">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="1.5" />
            <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
          </svg>
          <input type="text" placeholder="채널 검색..." id="search-input">
        </div>

        <div class="channels-container" id="channels-container">
          <!-- 카테고리와 채널들이 동적으로 추가됨 -->
        </div>
      </section>

      <!-- 사이드바 리사이저 -->
      <div class="resizer" id="sidebar-resizer" data-direction="horizontal"></div>

      <!-- 채팅 영역 -->
      <section class="chat-area" id="chat-area">
        <!-- 메시지와 멤버 영역 -->
        <div class="messages-and-members" id="messages-and-members" style="display: none;">
          <!-- 메시지 콘텐츠 -->
          <div class="chat-content">
            <!-- 채팅 미선택 상태 -->
            <div class="empty-state" id="empty-state">
              <div class="empty-icon">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"
                    stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
              </div>
              <h3>대화를 선택하세요</h3>
              <p>왼쪽에서 대화를 선택하거나 새 대화를 시작하세요</p>
            </div>

            <!-- 채팅 헤더 (채팅 선택 시 표시) -->
            <div class="chat-header" id="chat-header" style="display: none;">
              <div class="chat-header-info">
                <div class="avatar">
                  <span id="chat-avatar-text">T</span>
                </div>
                <div class="chat-header-text">
                  <h3 id="chat-title">팀 채널</h3>
                  <span class="chat-status" id="chat-status">3명 온라인</span>
                </div>
              </div>
              <div class="chat-header-actions">
                <button class="icon-btn" id="btn-voice-chat" title="음성채팅 시작">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" stroke="currentColor"
                      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M19 10v2a7 7 0 0 1-14 0v-2M12 19v4M8 23h8" stroke="currentColor" stroke-width="1.5"
                      stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </button>
                <button class="icon-btn" id="btn-screen-share" title="화면 공유">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <rect x="2" y="3" width="20" height="14" rx="2" stroke="currentColor" stroke-width="1.5" />
                    <path d="M8 21h8M12 17v4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                  </svg>
                </button>
                <button class="icon-btn" id="btn-whiteboard" title="화이트보드">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="1.5" />
                    <path d="M3 9h18M9 21V9" stroke="currentColor" stroke-width="1.5" />
                  </svg>
                </button>
                <button class="icon-btn" id="btn-pinned-messages" title="고정된 메시지" style="display: none;">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M12 2L9.5 9.5L2 12l7.5 2.5L12 22l2.5-7.5L22 12l-7.5-2.5L12 2z" stroke="currentColor"
                      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                  <span class="badge" id="pinned-count" style="display: none;">0</span>
                </button>
                <button class="icon-btn" id="btn-download-messages" title="메시지 다운로드">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3" stroke="currentColor"
                      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </button>
                <button class="icon-btn" id="btn-toggle-members" title="참여자">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2M16 11a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM23 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"
                      stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </button>
              </div>
            </div>

            <!-- 고정된 메시지 패널 -->
            <div class="pinned-messages-panel" id="pinned-panel" style="display: none;">
              <div class="pinned-header">
                <h4>고정된 메시지</h4>
                <button class="icon-btn" id="close-pinned-panel">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                  </svg>
                </button>
              </div>
              <div class="pinned-messages" id="pinned-messages">
                <!-- 고정된 메시지들이 표시됨 -->
              </div>
            </div>

            <!-- 메시지 영역 -->
            <div class="messages-container" id="messages-container" style="display: none;">
              <div class="messages" id="messages">
                <!-- 메시지들이 동적으로 추가됨 -->
              </div>
            </div>

            <!-- 메시지 컨텍스트 메뉴 -->
            <div class="context-menu" id="message-context-menu" style="display: none;">
              <button class="context-menu-item" data-action="thread">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M7 8h10M7 12h7M7 16h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                  <path d="M3 12h0M21 12h0" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                <span>스레드에서 답글</span>
              </button>
              <button class="context-menu-item" data-action="reaction">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="1.5" />
                  <path d="M8 14s1.5 2 4 2 4-2 4-2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                  <circle cx="9" cy="9" r="1" fill="currentColor" />
                  <circle cx="15" cy="9" r="1" fill="currentColor" />
                </svg>
                <span>리액션 추가</span>
              </button>
              <button class="context-menu-item" data-action="pin">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M12 2L9.5 9.5L2 12l7.5 2.5L12 22l2.5-7.5L22 12l-7.5-2.5L12 2z" stroke="currentColor"
                    stroke-width="1.5" />
                </svg>
                <span>메시지 고정</span>
              </button>
              <button class="context-menu-item" data-action="bookmark">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z" stroke="currentColor" stroke-width="1.5"
                    stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <span>나만 보기용으로 저장</span>
              </button>
              <button class="context-menu-item" data-action="remind">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <circle cx="12" cy="13" r="8" stroke="currentColor" stroke-width="1.5" />
                  <path d="M12 9v4l3 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                  <path d="M12 5V3M17 6l1.5-1.5M19 12h2M7 6L5.5 4.5M5 12H3" stroke="currentColor" stroke-width="1.5"
                    stroke-linecap="round" />
                </svg>
                <span>나중에 리마인드</span>
              </button>
              <button class="context-menu-item" data-action="move">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                </svg>
                <span>다른 채널로 이동</span>
              </button>
              <button class="context-menu-item" data-action="copy">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <rect x="9" y="9" width="13" height="13" rx="2" stroke="currentColor" stroke-width="1.5" />
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke="currentColor"
                    stroke-width="1.5" />
                </svg>
                <span>텍스트 복사</span>
              </button>
              <div class="context-menu-divider"></div>
              <button class="context-menu-item danger" data-action="delete">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
                    stroke="currentColor" stroke-width="1.5" />
                </svg>
                <span>메시지 삭제</span>
              </button>
            </div>

            <!-- 서버 컨텍스트 메뉴 -->
            <div class="context-menu" id="server-context-menu" style="display: none;">
              <button class="context-menu-item" data-server-action="invite">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M12 11a4 4 0 1 0-4-4 4 4 0 0 0 4 4z" stroke="currentColor" stroke-width="1.5"
                    stroke-linecap="round" stroke-linejoin="round" />
                  <path d="M4 20a6 6 0 0 1 16 0" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                  <path d="M19 9v4M21 11h-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                </svg>
                <span>사용자 초대</span>
              </button>
              <div class="context-menu-divider"></div>
              <button class="context-menu-item danger" data-server-action="delete">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
                    stroke="currentColor" stroke-width="1.5" />
                </svg>
                <span>서버 삭제</span>
              </button>
            </div>

            <!-- 채널 컨텍스트 메뉴 -->
            <div class="context-menu" id="channel-context-menu" style="display: none;">
              <button class="context-menu-item" data-channel-action="mark-read">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" />
                </svg>
                <span>읽음으로 표시</span>
              </button>
            </div>

            <!-- 이모티콘 선택 팝업 -->
            <div class="emoji-picker" id="emoji-picker" style="display: none;">
              <div class="emoji-picker-header">
                <h4>리액션 선택</h4>
              </div>
              <div class="emoji-picker-body">
                <div class="emoji-grid">
                  <button class="emoji-btn" data-emoji="👍">👍</button>
                  <button class="emoji-btn" data-emoji="❤️">❤️</button>
                  <button class="emoji-btn" data-emoji="😂">😂</button>
                  <button class="emoji-btn" data-emoji="😮">😮</button>
                  <button class="emoji-btn" data-emoji="😢">😢</button>
                  <button class="emoji-btn" data-emoji="🎉">🎉</button>
                  <button class="emoji-btn" data-emoji="🔥">🔥</button>
                  <button class="emoji-btn" data-emoji="👏">👏</button>
                  <button class="emoji-btn" data-emoji="✨">✨</button>
                  <button class="emoji-btn" data-emoji="💯">💯</button>
                  <button class="emoji-btn" data-emoji="🚀">🚀</button>
                  <button class="emoji-btn" data-emoji="👀">👀</button>
                  <button class="emoji-btn" data-emoji="🤔">🤔</button>
                  <button class="emoji-btn" data-emoji="💪">💪</button>
                  <button class="emoji-btn" data-emoji="🙏">🙏</button>
                  <button class="emoji-btn" data-emoji="⭐">⭐</button>
                </div>
              </div>
            </div>
          </div>

          <!-- 멤버 패널 리사이저 -->
          <div class="resizer" id="members-resizer" data-direction="vertical"></div>

          <!-- 멤버 패널 -->
          <aside class="members-panel" id="members-panel" style="display: none;">
            <div class="members-header">
              <h3>참여자</h3>
              <button class="icon-btn" id="toggle-members-panel" title="참여자 닫기">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                  <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
              </button>
            </div>
            <div class="members-search">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="1.5" />
                <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
              </svg>
              <input type="text" placeholder="참여자 검색..." id="members-search-input">
            </div>
            <div class="members-list" id="members-list">
              <!-- 멤버들이 동적으로 추가됨 -->
            </div>
          </aside>

          <!-- 스레드 패널 리사이저 -->
          <div class="resizer" id="thread-resizer" data-direction="vertical" style="display: none;"></div>

          <!-- 스레드 패널 -->
          <aside class="thread-panel" id="thread-panel" style="display: none;">
            <div class="thread-header">
              <div class="thread-header-info">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path d="M7 8h10M7 12h7M7 16h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                  <path d="M3 12h0M21 12h0" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                <h3>스레드</h3>
              </div>
              <button class="icon-btn" id="close-thread-panel" title="스레드 닫기">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                  <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
              </button>
            </div>

            <!-- 원본 메시지 -->
            <div class="thread-original-message" id="thread-original-message">
              <!-- 원본 메시지가 동적으로 추가됨 -->
            </div>

            <!-- 스레드 메시지 목록 -->
            <div class="thread-messages-container">
              <div class="thread-replies-header">
                <span id="thread-reply-count">0개의 답글</span>
              </div>
              <div class="thread-messages" id="thread-messages">
                <!-- 스레드 답글들이 동적으로 추가됨 -->
              </div>
            </div>

            <!-- 스레드 입력 영역 -->
            <div class="thread-input-area">
              <div class="thread-input-container">
                <textarea id="thread-input" placeholder="스레드에 답글 작성..." rows="1"></textarea>
                <button class="send-btn" id="send-thread-reply" disabled>
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                    <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" stroke="currentColor" stroke-width="2"
                      stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </button>
              </div>
            </div>
          </aside>
        </div>
        <!-- 입력 영역 리사이저 -->
        <div class="resizer" id="input-resizer" data-direction="horizontal"></div>

        <!-- 입력 영역 -->
        <div class="chat-header" id="chat-header" style="display: none;">
          <div class="header-left">
            <h3 class="chat-title" id="chat-title"># 일반</h3>
            <span class="chat-topic">채널 주제가 여기에 표시됩니다.</span>
          </div>
          <div class="header-right">
            <button class="icon-btn" title="음성/화상 통화" id="start-call-btn" onclick="app.webRTCManager.startCall()">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M23 7l-7 5 7 5V7z" />
                <rect x="1" y="5" width="15" height="14" rx="2" ry="2" />
              </svg>
            </button>
            <div class="search-bar">
              <!-- ... existing search bar ... -->
              <input type="text" placeholder="검색">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2" />
                <path d="M21 21L16.65 16.65" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              </svg>
            </div>
            <button class="icon-btn" title="알림 설정">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor"
                  stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </button>
            <button class="icon-btn" title="멤버 목록" onclick="app.uiManager.toggleMembersList()">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round" stroke-linejoin="round" />
                <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round" />
                <path d="M23 21v-2a4 4 0 0 0-3-3.87" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round" />
                <path d="M16 3.13a4 4 0 0 1 0 7.75" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
            </button>
          </div>
        </div>

        <!-- Chat Area -->
        <div class="messages-container" id="messages-container" style="display: none;">
          <!-- Messages injected here -->
          <div id="messages">
            <!-- 메시지들이 동적으로 추가됨 -->
          </div>
        </div>

        <!-- Input Area -->
        <div class="input-area" id="input-area" style="display: none;">
          <div class="input-tools">
            <button class="icon-btn attach-btn" title="첨부파일" id="attach-btn">
              <!-- ... -->
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path
                  d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"
                  stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
              </svg>
            </button>
            <button class="icon-btn emoji-btn" id="emoji-btn" title="이모지">
              <!-- ... -->
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="1.5" />
                <path d="M8 14s1.5 2 4 2 4-2 4-2M9 9h.01M15 9h.01" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round" />
              </svg>
            </button>
          </div>

          <div class="input-container">
            <!-- Typing Indicator -->
            <div id="typing-indicator" class="typing-indicator" style="display: none;"></div>

            <!-- Rich Text Editor Replacement -->
            <div class="rich-text-container">
              <div class="rte-toolbar">
                <button class="rte-btn" onclick="document.execCommand('bold', false, null)" title="Bold">
                  <b>B</b>
                </button>
                <button class="rte-btn" onclick="document.execCommand('italic', false, null)" title="Italic">
                  <i>I</i>
                </button>
                <button class="rte-btn" onclick="document.execCommand('underline', false, null)" title="Underline">
                  <u>U</u>
                </button>
                <button class="rte-btn" onclick="document.execCommand('strikeThrough', false, null)"
                  title="Strikethrough">
                  <s>S</s>
                </button>
                <div style="width: 1px; height: 16px; background: var(--border-light); margin: 0 4px;"></div>
                <button class="rte-btn" onclick="document.execCommand('insertUnorderedList', false, null)" title="List">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="8" y1="6" x2="21" y2="6"></line>
                    <line x1="8" y1="12" x2="21" y2="12"></line>
                    <line x1="8" y1="18" x2="21" y2="18"></line>
                    <line x1="3" y1="6" x2="3.01" y2="6"></line>
                    <line x1="3" y1="12" x2="3.01" y2="12"></line>
                    <line x1="3" y1="18" x2="3.01" y2="18"></line>
                  </svg>
                </button>
              </div>
              <div id="message-input" class="rte-editor" contenteditable="true" placeholder="메시지를 입력하세요..."></div>
            </div>

            <button class="send-btn" id="send-btn" disabled title="보내기">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" stroke="currentColor" stroke-width="1.5"
                  stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </button>
          </div>
          <div class="input-hints">
            <span><kbd>Enter</kbd> 전송</span>
            <span><kbd>Shift + Enter</kbd> 줄바꿈</span>
          </div>

          <!-- 자동완성 드롭다운 -->
          <div class="autocomplete-dropdown" id="autocomplete-dropdown" style="display: none;">
            <div class="autocomplete-items" id="autocomplete-items"></div>
          </div>

          <!-- 이모지 피커 -->
          <div class="emoji-picker" id="emoji-picker" style="display: none;">
            <div class="emoji-picker-header">
              <input type="text" class="emoji-search" id="emoji-search" placeholder="이모지 검색...">
            </div>
            <div class="emoji-categories" id="emoji-categories"></div>
            <div class="emoji-grid" id="emoji-grid"></div>
          </div>
        </div>
  </div>
  </section>
  </main>

  <!-- 설정 모달 -->
  <div class="modal-overlay" id="settings-modal" style="display: none;">
    <div class="modal">
      <div class="modal-header">
        <h3>설정</h3>
        <button class="icon-btn modal-close" id="close-settings">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="settings-section">
          <h4>프로필</h4>
          <div class="settings-item">
            <label>이름</label>
            <input type="text" id="settings-name" placeholder="이름 입력">
          </div>
          <div class="settings-item">
            <label>상태 메시지</label>
            <input type="text" id="settings-status" placeholder="상태 메시지">
          </div>
        </div>

        <div class="settings-section">
          <h4>알림</h4>
          <div class="settings-item toggle">
            <label>데스크톱 알림</label>
            <label class="switch">
              <input type="checkbox" id="settings-notifications" checked>
              <span class="slider"></span>
            </label>
          </div>
          <div class="settings-item toggle">
            <label>알림 소리</label>
            <label class="switch">
              <input type="checkbox" id="settings-sound" checked>
              <span class="slider"></span>
            </label>
          </div>
          <div class="settings-item">
            <button class="btn btn-secondary" id="btn-notification-settings" style="width: 100%; margin-top: 8px;">
              채널별 알림 설정
            </button>
          </div>
        </div>

        <div class="settings-section">
          <h4>보안</h4>
          <div class="settings-item">
            <label>비밀번호 변경</label>
            <button class="btn btn-secondary" id="btn-change-password" style="width: 100%; margin-top: 8px;">
              비밀번호 변경
            </button>
          </div>
          <div class="settings-item toggle">
            <div>
              <label>2단계 인증 (2FA)</label>
              <p style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">
                로그인 시 추가 보안 코드를 요구합니다
              </p>
            </div>
            <label class="switch">
              <input type="checkbox" id="settings-2fa-enabled">
              <span class="slider"></span>
            </label>
          </div>
        </div>

        <div class="settings-section">
          <h4>서버 연결</h4>
          <div class="settings-item">
            <label>서버 상태</label>
            <span class="connection-status" id="connection-status">
              <span class="status-dot disconnected"></span>
              연결 안됨
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 도움말 모달 -->
  <div class="modal-overlay" id="help-modal" style="display: none;">
    <div class="modal help-modal">
      <div class="modal-header">
        <h2>💬 슬래시 명령어</h2>
        <button class="icon-btn modal-close" onclick="document.getElementById('help-modal').style.display='none'">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="help-commands" id="help-commands-list">
          <!-- 명령어 목록이 여기에 동적으로 추가됩니다 -->
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="document.getElementById('help-modal').style.display='none'">
          닫기
        </button>
      </div>
    </div>
  </div>

  <!-- 멤버 프로필 모달 -->
  <div class="modal-overlay" id="member-profile-modal" style="display: none;">
    <div class="modal member-profile-modal">
      <div class="modal-header">
        <h2>👤 프로필</h2>
        <button class="icon-btn modal-close"
          onclick="document.getElementById('member-profile-modal').style.display='none'">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="profile-content">
          <div class="profile-avatar-large" id="profile-avatar"></div>
          <div class="profile-info">
            <div class="profile-field">
              <div class="profile-field-label">이름</div>
              <div class="profile-field-value" id="profile-name"></div>
            </div>
            <div class="profile-field">
              <div class="profile-field-label">닉네임</div>
              <div class="profile-field-value" id="profile-nickname"></div>
            </div>
            <div class="profile-field">
              <div class="profile-field-label">역할</div>
              <div class="profile-field-value" id="profile-role"></div>
            </div>
            <div class="profile-field">
              <div class="profile-field-label">상태</div>
              <div class="profile-field-value" id="profile-status"></div>
            </div>

            <!-- 조직 정보 (업무용) -->
            <div class="profile-section-title">조직 정보</div>
            <div class="profile-field">
              <div class="profile-field-label">부서</div>
              <div class="profile-field-value" id="profile-department">-</div>
            </div>
            <div class="profile-field">
              <div class="profile-field-label">직책</div>
              <div class="profile-field-value" id="profile-job-title">-</div>
            </div>
            <div class="profile-field">
              <div class="profile-field-label">내선번호</div>
              <div class="profile-field-value" id="profile-extension">-</div>
            </div>
            <div class="profile-field">
              <div class="profile-field-label">회사 번호</div>
              <div class="profile-field-value" id="profile-phone">-</div>
            </div>
            <div class="profile-field">
              <div class="profile-field-label">근무지</div>
              <div class="profile-field-value" id="profile-location">-</div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div id="profile-role-actions" style="display: none; gap: 8px; margin-right: auto;">
          <select id="profile-role-select" class="role-select">
            <option value="owner">소유자</option>
            <option value="admin">관리자</option>
            <option value="moderator">모더레이터</option>
            <option value="member">멤버</option>
          </select>
          <button class="btn btn-primary" onclick="window.app.updateMemberRole()">역할 변경</button>
        </div>
        <button class="btn btn-primary" id="btn-edit-profile" onclick="window.app.showEditProfileModal()"
          style="margin-right: auto;">
          프로필 편집
        </button>
        <button class="btn btn-secondary"
          onclick="document.getElementById('member-profile-modal').style.display='none'">
          닫기
        </button>
      </div>
    </div>
  </div>

  <!-- 프로필 편집 모달 -->
  <div class="modal-overlay" id="edit-profile-modal" style="display: none;">
    <div class="modal edit-profile-modal">
      <div class="modal-header">
        <h2>프로필 편집</h2>
        <button class="icon-btn modal-close"
          onclick="document.getElementById('edit-profile-modal').style.display='none'">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <form id="edit-profile-form">
          <div class="form-group">
            <label for="edit-profile-name">이름</label>
            <input type="text" id="edit-profile-name" placeholder="이름을 입력하세요">
          </div>

          <div class="form-group">
            <label for="edit-profile-email">이메일</label>
            <input type="email" id="edit-profile-email" placeholder="이메일을 입력하세요">
          </div>

          <div class="form-group">
            <label for="edit-profile-nickname">닉네임</label>
            <input type="text" id="edit-profile-nickname" placeholder="닉네임을 입력하세요">
          </div>

          <div class="form-group">
            <label for="edit-profile-status-msg">상태 메시지</label>
            <input type="text" id="edit-profile-status-msg" placeholder="상태 메시지를 입력하세요">
          </div>

          <div class="profile-section-title" style="margin-top: 16px;">조직 정보</div>

          <div class="form-group">
            <label for="edit-profile-department">부서</label>
            <input type="text" id="edit-profile-department" placeholder="예: 개발팀, 기획팀, 영업팀">
          </div>

          <div class="form-group">
            <label for="edit-profile-job-title">직책</label>
            <input type="text" id="edit-profile-job-title" placeholder="예: 주임, 대리, 과장, 차장, 부장">
          </div>

          <div class="form-group">
            <label for="edit-profile-extension">내선번호</label>
            <input type="text" id="edit-profile-extension" placeholder="예: 1234">
          </div>

          <div class="form-group">
            <label for="edit-profile-phone">회사 번호</label>
            <input type="text" id="edit-profile-phone" placeholder="예: 02-1234-5678">
          </div>

          <div class="form-group">
            <label for="edit-profile-location">근무지</label>
            <input type="text" id="edit-profile-location" placeholder="예: 본사, 강남지점, 재택">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="document.getElementById('edit-profile-modal').style.display='none'">
          취소
        </button>
        <button class="btn btn-primary" onclick="window.app.saveProfileEdits()">
          저장
        </button>
      </div>
    </div>
  </div>

  <!-- 입력 다이얼로그 모달 -->
  <div class="modal-overlay" id="input-dialog-overlay" style="display: none;">
    <div class="modal input-dialog">
      <div class="modal-header">
        <h3 id="input-dialog-title">입력</h3>
        <button class="icon-btn modal-close" id="input-dialog-close">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <input type="text" id="input-dialog-input" placeholder="입력하세요">
      </div>
      <div class="modal-actions">
        <button class="btn-cancel" id="input-dialog-cancel">취소</button>
        <button class="btn-primary" id="input-dialog-ok">확인</button>
      </div>
    </div>
  </div>

  <!-- 채널 권한 설정 모달 -->
  <div class="modal-overlay" id="channel-permission-dialog" style="display: none;">
    <div class="modal channel-permission-modal">
      <div class="modal-header">
        <h3 id="channel-permission-title">채널 설정</h3>
        <button class="icon-btn modal-close" id="channel-permission-close">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="channel-perm-name">채널 이름</label>
          <input type="text" id="channel-perm-name" placeholder="채널 이름을 입력하세요">
        </div>

        <div class="form-group">
          <label class="checkbox-label">
            <input type="checkbox" id="channel-perm-private">
            <span>비공개 채널</span>
          </label>
          <small class="form-hint">비공개 채널은 허용된 역할/멤버만 접근할 수 있습니다</small>
        </div>

        <div class="form-group" id="channel-perm-access-group" style="display: none;">
          <label for="channel-perm-roles">접근 허용 역할 (쉼표로 구분)</label>
          <input type="text" id="channel-perm-roles" placeholder="예: admin, moderator">
          <small class="form-hint">비어있으면 역할 제한 없음</small>
        </div>

        <div class="form-group" id="channel-perm-members-group" style="display: none;">
          <label for="channel-perm-members">접근 허용 멤버 ID (쉼표로 구분)</label>
          <input type="text" id="channel-perm-members" placeholder="예: user1, user2">
          <small class="form-hint">비어있으면 멤버 제한 없음</small>
        </div>

        <div class="form-group">
          <label for="channel-perm-post">메시지 전송 권한</label>
          <select id="channel-perm-post">
            <option value="everyone">모든 멤버</option>
            <option value="admin_only">관리자만</option>
            <option value="owner_only">소유자만</option>
          </select>
          <small class="form-hint">누가 이 채널에 메시지를 보낼 수 있는지 설정합니다</small>
        </div>
      </div>
      <div class="modal-actions">
        <button class="btn-cancel" id="channel-permission-cancel">취소</button>
        <button class="btn-primary" id="channel-permission-ok">확인</button>
      </div>
    </div>
  </div>

  <!-- 음성채팅 모달 -->
  <div class="modal-overlay" id="voice-chat-modal" style="display: none;">
    <div class="modal voice-chat-modal">
      <div class="modal-header">
        <h3>음성채팅</h3>
        <div class="modal-header-actions">
          <button class="icon-btn" id="minimize-voice-chat" title="축소">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
          </button>
          <button class="icon-btn modal-close" id="close-voice-chat">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
          </button>
        </div>
      </div>
      <div class="modal-body">
        <div class="voice-chat-status">
          <div class="voice-chat-timer" id="voice-timer">00:00</div>
          <p id="voice-status-text">음성채팅에 연결 중...</p>
        </div>
        <div class="voice-participants" id="voice-participants">
          <!-- 참여자 목록이 동적으로 추가됨 -->
        </div>
        <div class="voice-controls">
          <button class="voice-btn" id="btn-toggle-mic" title="마이크 토글">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" stroke="currentColor" stroke-width="2" />
              <path d="M19 10v2a7 7 0 0 1-14 0v-2M12 19v4M8 23h8" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" />
            </svg>
            <span>음소거</span>
          </button>
          <button class="voice-btn" id="btn-toggle-speaker" title="스피커 토글">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M11 5L6 9H2v6h4l5 4V5zM19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <span>스피커</span>
          </button>
          <button class="voice-btn danger" id="btn-leave-voice" title="음성채팅 나가기">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M23 3l-7 18-4-9-9-4 20-5z" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" />
              <path d="M12 12L3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
            <span>나가기</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- 화면 공유 모달 -->
  <div class="modal-overlay" id="screen-share-modal" style="display: none;">
    <div class="modal screen-share-modal">
      <div class="modal-header">
        <h3>화면 공유</h3>
        <div class="modal-header-actions">
          <button class="icon-btn" id="minimize-screen-share" title="축소">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
          </button>
          <button class="icon-btn modal-close" id="close-screen-share">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
          </button>
        </div>
      </div>
      <div class="modal-body">
        <div class="screen-share-options">
          <div class="share-option" id="share-entire-screen">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
              <rect x="2" y="3" width="20" height="14" rx="2" stroke="currentColor" stroke-width="1.5" />
              <path d="M8 21h8M12 17v4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            </svg>
            <h4>전체 화면</h4>
            <p>전체 화면을 공유합니다</p>
          </div>
          <div class="share-option" id="share-window">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
              <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="1.5" />
              <path d="M9 3v18" stroke="currentColor" stroke-width="1.5" />
            </svg>
            <h4>특정 창</h4>
            <p>선택한 창을 공유합니다</p>
          </div>
          <div class="share-option" id="share-tab">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
              <rect x="3" y="6" width="18" height="14" rx="2" stroke="currentColor" stroke-width="1.5" />
              <path d="M3 10h18" stroke="currentColor" stroke-width="1.5" />
            </svg>
            <h4>브라우저 탭</h4>
            <p>브라우저 탭을 공유합니다</p>
          </div>
        </div>
        <div class="screen-share-preview" id="screen-preview" style="display: none;">
          <video id="screen-video" autoplay></video>
          <div class="share-controls">
            <button class="btn-cancel" id="btn-stop-share">공유 중지</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 일정관리 달력 모달 -->
  <div class="modal-overlay" id="calendar-modal" style="display: none;">
    <div class="modal calendar-modal">
      <div class="modal-header">
        <h3>일정관리</h3>
        <button class="icon-btn modal-close" id="close-calendar">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="calendar-header">
          <button class="icon-btn" id="prev-month">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
          </button>
          <h4 id="current-month">2025년 12월</h4>
          <button class="icon-btn" id="next-month">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
          </button>
        </div>
        <div class="calendar-grid">
          <div class="calendar-weekdays">
            <div>일</div>
            <div>월</div>
            <div>화</div>
            <div>수</div>
            <div>목</div>
            <div>금</div>
            <div>토</div>
          </div>
          <div class="calendar-days" id="calendar-days">
            <!-- 날짜가 동적으로 추가됨 -->
          </div>
        </div>
        <div class="calendar-events">
          <div class="events-header">
            <h4>일정</h4>
            <button class="btn-primary small" id="btn-add-event">일정 추가</button>
          </div>
          <div class="events-list" id="events-list">
            <!-- 일정 목록이 동적으로 추가됨 -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 마이페이지 모달 -->
  <div class="modal-overlay" id="mypage-modal" style="display: none;">
    <div class="modal mypage-modal">
      <div class="modal-header">
        <h3>마이페이지</h3>
        <button class="icon-btn modal-close" id="close-mypage">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="profile-section">
          <div class="profile-avatar-large" id="profile-avatar-large">
            <span id="profile-avatar-text">U</span>
          </div>
          <div class="profile-info">
            <h4 id="profile-name">사용자</h4>
            <div class="status-selector">
              <button class="status-btn" data-status="online">
                <span class="status-dot online"></span>
                온라인
              </button>
              <button class="status-btn" data-status="away">
                <span class="status-dot away"></span>
                자리비움
              </button>
              <button class="status-btn" data-status="busy">
                <span class="status-dot busy"></span>
                방해금지
              </button>
              <button class="status-btn" data-status="offline">
                <span class="status-dot offline"></span>
                오프라인
              </button>
            </div>
          </div>
        </div>
        <div class="profile-details">
          <div class="detail-item">
            <label>이름</label>
            <input type="text" id="profile-name-input" placeholder="이름 입력">
          </div>
          <div class="detail-item">
            <label>상태 메시지</label>
            <input type="text" id="profile-status-msg" placeholder="상태 메시지">
          </div>
          <div class="detail-item">
            <label>이메일</label>
            <input type="email" id="profile-email" placeholder="이메일 주소">
          </div>
          <div class="detail-item">
            <label>전화번호</label>
            <input type="tel" id="profile-phone" placeholder="전화번호">
          </div>
        </div>
        <div class="modal-actions">
          <button class="btn-cancel" id="cancel-profile">취소</button>
          <button class="btn-primary" id="save-profile">저장</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 일정 추가 모달 -->
  <div class="modal-overlay" id="add-event-modal" style="display: none;">
    <div class="modal event-modal">
      <div class="modal-header">
        <h3>일정 추가</h3>
        <button class="icon-btn modal-close" id="close-add-event">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="detail-item">
          <label>제목</label>
          <input type="text" id="event-title" placeholder="일정 제목">
        </div>
        <div class="detail-item">
          <label>날짜</label>
          <input type="date" id="event-date">
        </div>
        <div class="detail-item">
          <label>시간</label>
          <input type="time" id="event-time">
        </div>
        <div class="detail-item">
          <label>설명</label>
          <textarea id="event-description" placeholder="일정 설명" rows="3"></textarea>
        </div>
      </div>
      <div class="modal-actions">
        <button class="btn-cancel" id="cancel-event">취소</button>
        <button class="btn-primary" id="save-event">저장</button>
      </div>
    </div>
  </div>

  <!-- 화이트보드 모달 -->
  <div class="modal-overlay" id="whiteboard-modal" style="display: none;">
    <div class="modal whiteboard-modal">
      <div class="modal-header">
        <h3>화이트보드</h3>
        <button class="icon-btn modal-close" id="close-whiteboard">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body whiteboard-body">
        <div class="whiteboard-toolbar">
          <div class="toolbar-group">
            <button class="tool-btn active" data-tool="pen" title="펜">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M12 19l7-7 3 3-7 7-3-3z" stroke="currentColor" stroke-width="2" />
                <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z" stroke="currentColor" stroke-width="2" />
                <path d="M2 2l7.586 7.586" stroke="currentColor" stroke-width="2" />
                <circle cx="11" cy="11" r="2" stroke="currentColor" stroke-width="2" />
              </svg>
            </button>
            <button class="tool-btn" data-tool="eraser" title="지우개">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M20 20H7L2 15l9.5-9.5a1 1 0 0 1 1.42 0l9.08 9.08a1 1 0 0 1 0 1.42L17 20z" stroke="currentColor"
                  stroke-width="2" />
                <path d="M8.5 13L13 17.5" stroke="currentColor" stroke-width="2" />
              </svg>
            </button>
            <button class="tool-btn" data-tool="line" title="직선">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M5 19l14-14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              </svg>
            </button>
            <button class="tool-btn" data-tool="rectangle" title="사각형">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2" />
              </svg>
            </button>
            <button class="tool-btn" data-tool="circle" title="원">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
              </svg>
            </button>
            <button class="tool-btn" data-tool="text" title="텍스트">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M4 7V4h16v3M9 20h6M12 4v16" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              </svg>
            </button>
          </div>
          <div class="toolbar-divider"></div>
          <div class="toolbar-group">
            <div class="color-picker-wrapper">
              <label>색상</label>
              <input type="color" id="wb-color" value="#6366f1">
            </div>
            <div class="slider-wrapper">
              <label>굵기</label>
              <input type="range" id="wb-width" min="1" max="20" value="3">
              <span id="wb-width-value">3</span>
            </div>
            <div class="checkbox-wrapper">
              <label>
                <input type="checkbox" id="wb-fill">
                채우기
              </label>
            </div>
          </div>
          <div class="toolbar-divider"></div>
          <div class="toolbar-group">
            <div class="color-picker-wrapper">
              <label>배경</label>
              <input type="color" id="wb-bg-color" value="#ffffff">
            </div>
            <div class="checkbox-wrapper">
              <label>
                <input type="checkbox" id="wb-grid">
                그리드
              </label>
            </div>
            <button class="tool-btn" id="wb-upload-image" title="이미지 업로드">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2" />
                <circle cx="8.5" cy="8.5" r="1.5" fill="currentColor" />
                <path d="M21 15l-5-5L5 21" stroke="currentColor" stroke-width="2" />
              </svg>
            </button>
            <input type="file" id="wb-image-input" accept="image/*" style="display: none;">
          </div>
          <div class="toolbar-divider"></div>
          <div class="toolbar-group">
            <button class="tool-btn" id="wb-clear" title="전체 지우기">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
                  stroke="currentColor" stroke-width="2" />
              </svg>
            </button>
            <button class="tool-btn" id="wb-undo" title="실행 취소">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M3 7v6h6M3 13a9 9 0 1 0 9-9" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              </svg>
            </button>
            <button class="tool-btn" id="wb-redo" title="다시 실행">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M21 7v6h-6M21 13a9 9 0 1 1-9-9" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round" />
              </svg>
            </button>
            <button class="tool-btn" id="wb-download" title="다운로드">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3" stroke="currentColor"
                  stroke-width="2" stroke-linecap="round" />
              </svg>
            </button>
          </div>
        </div>
        <div class="whiteboard-canvas-container">
          <canvas id="whiteboard-canvas"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- 축소된 창 표시 영역 -->
  <div class="minimized-windows" id="minimized-windows">
    <!-- 음성채팅 축소 창 -->
    <div class="minimized-window" id="minimized-voice-chat" style="display: none;">
      <div class="minimized-window-content">
        <div class="minimized-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" stroke="currentColor" stroke-width="2" />
            <path d="M19 10v2a7 7 0 0 1-14 0v-2M12 19v4M8 23h8" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" />
          </svg>
        </div>
        <div class="minimized-info">
          <div class="minimized-title">음성채팅</div>
          <div class="minimized-status" id="minimized-voice-timer">00:00</div>
        </div>
        <button class="minimized-restore" data-restore="voice-chat" title="복원">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
    </div>

    <!-- 화면 공유 축소 창 -->
    <div class="minimized-window" id="minimized-screen-share" style="display: none;">
      <div class="minimized-window-content">
        <div class="minimized-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <rect x="2" y="3" width="20" height="14" rx="2" stroke="currentColor" stroke-width="2" />
            <path d="M8 21h8M12 17v4" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </div>
        <div class="minimized-info">
          <div class="minimized-title">화면 공유</div>
          <div class="minimized-status">공유 중</div>
        </div>
        <button class="minimized-restore" data-restore="screen-share" title="복원">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
    </div>
  </div>
  </div>

  <!-- 검색 모달 (Ctrl+K) -->
  <div class="modal-overlay" id="search-modal" style="display: none;">
    <div class="modal search-modal">
      <div class="modal-header">
        <h2>🔍 검색</h2>
        <button class="icon-btn modal-close" id="close-search">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="search-input-container">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" class="search-icon">
            <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2" />
            <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
          <input type="text" id="search-input" placeholder="사용자 또는 메시지 검색..." autocomplete="off">
        </div>
        <div class="search-filters">
          <button class="filter-btn active" data-filter="all">전체</button>
          <button class="filter-btn" data-filter="users">사용자</button>
          <button class="filter-btn" data-filter="messages">메시지</button>
        </div>
        <div class="search-results" id="search-results">
          <div class="search-empty">
            <p>검색어를 입력하세요 (최소 2글자)</p>
          </div>
        </div>
      </div>
    </div>

    <!-- 전체 검색 모달 -->
    <div class="modal-overlay" id="global-search-modal" style="display: none;">
      <div class="modal search-modal">
        <div class="modal-header">
          <h3>메시지 검색</h3>
          <button class="icon-btn modal-close" id="close-global-search">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <div class="search-input-container">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2" />
              <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
            <input type="text" id="global-search-input" placeholder="메시지 검색..." autofocus>
          </div>

          <div class="search-filters">
            <input type="text" id="search-author" placeholder="작성자 (선택사항)">
            <input type="date" id="search-from-date" placeholder="시작 날짜">
            <input type="date" id="search-to-date" placeholder="종료 날짜">
            <label class="checkbox-label">
              <input type="checkbox" id="search-my-messages">
              <span>내 메시지만</span>
            </label>
          </div>

          <div class="search-tabs">
            <button class="search-tab active" data-tab="messages">메시지</button>
            <button class="search-tab" data-tab="files">파일</button>
          </div>

          <div class="search-results" id="search-results">
            <div class="search-placeholder">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
                <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="1.5" />
                <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
              </svg>
              <p>검색어를 입력하여 메시지를 찾아보세요</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 멘션 모달 -->
  <div class="modal-overlay" id="mentions-modal" style="display: none;">
    <div class="modal search-modal">
      <div class="modal-header">
        <h3>내 멘션</h3>
        <button class="icon-btn modal-close" onclick="app.closeMentionsModal()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div id="mentions-list" class="mentions-list">
          <div class="search-placeholder">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="1.5" />
              <path d="M12 8v4M12 16h.01" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            </svg>
            <p>멘션이 없습니다</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 채널별 알림 설정 모달 -->
  <div class="modal-overlay" id="notification-settings-modal" style="display: none;">
    <div class="modal">
      <div class="modal-header">
        <h3>알림 설정</h3>
        <button class="icon-btn modal-close" onclick="app.closeNotificationSettingsModal()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="notification-settings-info">
          <p>채널별로 알림을 받는 방식을 설정할 수 있습니다.</p>
        </div>

        <div class="settings-section">
          <h4>서버 알림</h4>
          <div id="server-notification-list" class="notification-list">
            <!-- 서버별 알림 설정이 여기에 추가됩니다 -->
          </div>
        </div>

        <div class="settings-section">
          <h4>채널 알림</h4>
          <div id="channel-notification-list" class="notification-list">
            <!-- 채널별 알림 설정이 여기에 추가됩니다 -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 비밀번호 찾기 모달 -->
  <div class="modal-overlay" id="forgot-password-modal" style="display: none;">
    <div class="modal">
      <div class="modal-header">
        <h3>비밀번호 찾기</h3>
        <button class="icon-btn modal-close" id="close-forgot-password">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <p style="margin-bottom: 16px; color: var(--text-secondary);">
          가입하신 이메일 주소를 입력하시면 비밀번호 재설정 링크를 보내드립니다.
        </p>
        <form id="forgot-password-form">
          <div class="form-group">
            <label for="forgot-email">이메일</label>
            <input type="email" id="forgot-email" placeholder="이메일을 입력하세요" required autocomplete="email">
          </div>
          <div class="modal-actions">
            <button type="button" class="btn-cancel" id="cancel-forgot-password">취소</button>
            <button type="submit" class="btn-primary">재설정 링크 발송</button>
          </div>
        </form>
        <div id="forgot-password-success" style="display: none; text-align: center; padding: 20px;">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none"
            style="color: var(--success); margin: 0 auto 12px;">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
            <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
          <h4 style="margin-bottom: 8px;">이메일을 확인하세요</h4>
          <p style="color: var(--text-secondary);">
            해당 이메일로 비밀번호 재설정 링크를 보냈습니다.<br>
            이메일을 확인하여 비밀번호를 재설정하세요.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- 비밀번호 재설정 모달 -->
  <div class="modal-overlay" id="reset-password-modal" style="display: none;">
    <div class="modal">
      <div class="modal-header">
        <h3>비밀번호 재설정</h3>
        <button class="icon-btn modal-close" id="close-reset-password">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <p style="margin-bottom: 16px; color: var(--text-secondary);">
          새로운 비밀번호를 입력하세요.
        </p>
        <form id="reset-password-form">
          <input type="hidden" id="reset-token" value="">
          <div class="form-group">
            <label for="new-password">새 비밀번호</label>
            <input type="password" id="new-password" placeholder="새 비밀번호 입력 (최소 6자)" required minlength="6"
              autocomplete="new-password">
          </div>
          <div class="form-group">
            <label for="confirm-password">비밀번호 확인</label>
            <input type="password" id="confirm-password" placeholder="비밀번호 다시 입력" required minlength="6"
              autocomplete="new-password">
          </div>
          <div class="modal-actions">
            <button type="button" class="btn-cancel" id="cancel-reset-password">취소</button>
            <button type="submit" class="btn-primary">비밀번호 변경</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- 저장한 메시지 모달 -->
  <div class="modal-overlay" id="saved-messages-modal" style="display: none;">
    <div class="modal saved-messages-modal">
      <div class="modal-header">
        <h3>저장한 메시지</h3>
        <button class="icon-btn modal-close" id="close-saved-messages">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="saved-messages-info" style="margin-bottom: 16px; color: var(--text-secondary); font-size: 14px;">
          나만 볼 수 있도록 저장한 메시지들입니다. 중요한 정보나 TODO를 기록하세요.
        </div>
        <div class="saved-messages-list" id="saved-messages-list">
          <!-- 저장한 메시지들이 동적으로 추가됨 -->
          <div class="saved-messages-empty" id="saved-messages-empty">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none"
              style="color: var(--text-tertiary); margin: 0 auto 16px;">
              <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z" stroke="currentColor" stroke-width="1.5"
                stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <p style="color: var(--text-secondary); text-align: center;">
              저장한 메시지가 없습니다.<br>
              메시지를 우클릭하여 저장할 수 있습니다.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- DM (다이렉트 메시지) 모달 -->
  <div class="modal-overlay" id="dm-modal" style="display: none;">
    <div class="modal dm-modal">
      <div class="modal-header">
        <h3>다이렉트 메시지</h3>
        <button class="icon-btn modal-close" id="close-dm-modal">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="dm-search" style="margin-bottom: 16px;">
          <input type="text" id="dm-search-input" placeholder="사용자 검색..."
            style="width: 100%; padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-secondary); color: var(--text-primary);">
        </div>
        <div class="dm-list" id="dm-list">
          <!-- DM 목록이 동적으로 추가됨 -->
          <div class="dm-empty" id="dm-empty">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none"
              style="color: var(--text-tertiary); margin: 0 auto 16px;">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke="currentColor"
                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <p style="color: var(--text-secondary); text-align: center;">
              다이렉트 메시지가 없습니다.<br>
              다른 사용자와 개인적으로 대화를 시작해보세요.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 리마인더 설정 모달 -->
  <div class="modal-overlay" id="reminder-modal" style="display: none;">
    <div class="modal">
      <div class="modal-header">
        <h3>리마인더 설정</h3>
        <button class="icon-btn modal-close" id="close-reminder-modal">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="reminder-setup">
          <div class="form-group">
            <label>리마인더 내용</label>
            <input type="text" id="reminder-text" class="form-input" placeholder='예: "이거 회신하기"' />
          </div>

          <div class="form-group">
            <label>알림 시간</label>
            <div class="reminder-time-options">
              <button class="reminder-time-btn" data-minutes="10">10분 후</button>
              <button class="reminder-time-btn" data-minutes="30">30분 후</button>
              <button class="reminder-time-btn" data-minutes="60">1시간 후</button>
              <button class="reminder-time-btn" data-minutes="240">4시간 후</button>
              <button class="reminder-time-btn" data-minutes="1440">내일</button>
              <button class="reminder-time-btn" id="custom-time-btn">직접 설정</button>
            </div>
          </div>

          <div class="form-group" id="custom-time-group" style="display: none;">
            <label>날짜 및 시간</label>
            <input type="datetime-local" id="reminder-custom-time" class="form-input" />
          </div>

          <div class="reminder-info" id="reminder-selected-time" style="display: none;">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="1.5" />
              <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            </svg>
            <span id="reminder-time-display"></span>
          </div>

          <div class="modal-footer">
            <button class="btn-secondary" id="cancel-reminder-btn">취소</button>
            <button class="btn-primary" id="create-reminder-btn" disabled>리마인더 생성</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 2FA 설정 모달 -->
  <div class="modal-overlay" id="2fa-setup-modal" style="display: none;">
    <div class="modal">
      <div class="modal-header">
        <h3>2단계 인증 설정</h3>
        <button class="icon-btn modal-close" id="close-2fa-setup">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div id="2fa-setup-step1">
          <h4 style="margin-bottom: 12px;">1단계: QR 코드 스캔</h4>
          <p style="margin-bottom: 16px; color: var(--text-secondary);">
            Google Authenticator, Authy 또는 다른 인증 앱으로 아래 QR 코드를 스캔하세요.
          </p>
          <div style="text-align: center; margin: 20px 0;">
            <img id="2fa-qr-code" src="" alt="QR Code"
              style="max-width: 200px; border: 1px solid var(--border); border-radius: 8px; padding: 12px;">
          </div>
          <div class="form-group">
            <label>또는 시크릿 키를 수동으로 입력:</label>
            <input type="text" id="2fa-secret" readonly
              style="font-family: monospace; background: var(--background-secondary);">
          </div>
          <h4 style="margin: 24px 0 12px;">2단계: 인증 코드 입력</h4>
          <p style="margin-bottom: 16px; color: var(--text-secondary);">
            인증 앱에 표시된 6자리 코드를 입력하여 설정을 완료하세요.
          </p>
          <form id="2fa-verify-form">
            <div class="form-group">
              <label for="2fa-verify-code">인증 코드</label>
              <input type="text" id="2fa-verify-code" placeholder="6자리 코드 입력" maxlength="6" pattern="[0-9]{6}" required
                autocomplete="one-time-code">
            </div>
            <div class="modal-actions">
              <button type="button" class="btn-cancel" id="cancel-2fa-setup">취소</button>
              <button type="submit" class="btn-primary">2FA 활성화</button>
            </div>
          </form>
        </div>
        <div id="2fa-setup-success" style="display: none; text-align: center; padding: 20px;">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none"
            style="color: var(--success); margin: 0 auto 12px;">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
            <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
          <h4 style="margin-bottom: 8px;">2단계 인증이 활성화되었습니다</h4>
          <p style="color: var(--text-secondary); margin-bottom: 20px;">
            이제 로그인 시 인증 코드를 입력해야 합니다.
          </p>
          <button class="btn-primary"
            onclick="document.getElementById('2fa-setup-modal').style.display='none'">확인</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 서버 컨텍스트 메뉴 -->
  <div class="context-menu" id="server-context-menu" style="display: none;">
    <div class="context-menu-item" id="ctx-server-invite">초대하기</div>
    <div class="context-menu-item" id="ctx-server-settings">서버 설정</div>
    <div class="context-menu-divider"></div>
    <div class="context-menu-item danger" id="ctx-server-leave">서버 나가기</div>
  </div>

  <!-- 채널 컨텍스트 메뉴 -->
  <div class="context-menu" id="channel-context-menu" style="display: none;">
    <div class="context-menu-item" id="ctx-channel-edit">채널 편집</div>
    <button type="button" class="btn-cancel" id="cancel-reset-password">취소</button>
    <button type="submit" class="btn-primary">비밀번호 변경</button>
  </div>
  </form>
  </div>
  </div>
  </div>

  <!-- 저장한 메시지 모달 -->
  <div class="modal-overlay" id="saved-messages-modal" style="display: none;">
    <div class="modal saved-messages-modal">
      <div class="modal-header">
        <h3>저장한 메시지</h3>
        <button class="icon-btn modal-close" id="close-saved-messages">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="saved-messages-info" style="margin-bottom: 16px; color: var(--text-secondary); font-size: 14px;">
          나만 볼 수 있도록 저장한 메시지들입니다. 중요한 정보나 TODO를 기록하세요.
        </div>
        <div class="saved-messages-list" id="saved-messages-list">
          <!-- 저장한 메시지들이 동적으로 추가됨 -->
          <div class="saved-messages-empty" id="saved-messages-empty">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none"
              style="color: var(--text-tertiary); margin: 0 auto 16px;">
              <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z" stroke="currentColor" stroke-width="1.5"
                stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <p style="color: var(--text-secondary); text-align: center;">
              저장한 메시지가 없습니다.<br>
              메시지를 우클릭하여 저장할 수 있습니다.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- DM (다이렉트 메시지) 모달 -->
  <div class="modal-overlay" id="dm-modal" style="display: none;">
    <div class="modal dm-modal">
      <div class="modal-header">
        <h3>다이렉트 메시지</h3>
        <button class="icon-btn modal-close" id="close-dm-modal">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="dm-search" style="margin-bottom: 16px;">
          <input type="text" id="dm-search-input" placeholder="사용자 검색..."
            style="width: 100%; padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-secondary); color: var(--text-primary);">
        </div>
        <div class="dm-list" id="dm-list">
          <!-- DM 목록이 동적으로 추가됨 -->
          <div class="dm-empty" id="dm-empty">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none"
              style="color: var(--text-tertiary); margin: 0 auto 16px;">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke="currentColor"
                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <p style="color: var(--text-secondary); text-align: center;">
              다이렉트 메시지가 없습니다.<br>
              다른 사용자와 개인적으로 대화를 시작해보세요.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 리마인더 설정 모달 -->
  <div class="modal-overlay" id="reminder-modal" style="display: none;">
    <div class="modal">
      <div class="modal-header">
        <h3>리마인더 설정</h3>
        <button class="icon-btn modal-close" id="close-reminder-modal">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="reminder-setup">
          <div class="form-group">
            <label>리마인더 내용</label>
            <input type="text" id="reminder-text" class="form-input" placeholder='예: "이거 회신하기"' />
          </div>

          <div class="form-group">
            <label>알림 시간</label>
            <div class="reminder-time-options">
              <button class="reminder-time-btn" data-minutes="10">10분 후</button>
              <button class="reminder-time-btn" data-minutes="30">30분 후</button>
              <button class="reminder-time-btn" data-minutes="60">1시간 후</button>
              <button class="reminder-time-btn" data-minutes="240">4시간 후</button>
              <button class="reminder-time-btn" data-minutes="1440">내일</button>
              <button class="reminder-time-btn" id="custom-time-btn">직접 설정</button>
            </div>
          </div>

          <div class="form-group" id="custom-time-group" style="display: none;">
            <label>날짜 및 시간</label>
            <input type="datetime-local" id="reminder-custom-time" class="form-input" />
          </div>

          <div class="reminder-info" id="reminder-selected-time" style="display: none;">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="1.5" />
              <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            </svg>
            <span id="reminder-time-display"></span>
          </div>

          <div class="modal-footer">
            <button class="btn-secondary" id="cancel-reminder-btn">취소</button>
            <button class="btn-primary" id="create-reminder-btn" disabled>리마인더 생성</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 2FA 설정 모달 -->
  <div class="modal-overlay" id="2fa-setup-modal" style="display: none;">
    <div class="modal">
      <div class="modal-header">
        <h3>2단계 인증 설정</h3>
        <button class="icon-btn modal-close" id="close-2fa-setup">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div id="2fa-setup-step1">
          <h4 style="margin-bottom: 12px;">1단계: QR 코드 스캔</h4>
          <p style="margin-bottom: 16px; color: var(--text-secondary);">
            Google Authenticator, Authy 또는 다른 인증 앱으로 아래 QR 코드를 스캔하세요.
          </p>
          <div style="text-align: center; margin: 20px 0;">
            <img id="2fa-qr-code" src="" alt="QR Code"
              style="max-width: 200px; border: 1px solid var(--border); border-radius: 8px; padding: 12px;">
          </div>
          <div class="form-group">
            <label>또는 시크릿 키를 수동으로 입력:</label>
            <input type="text" id="2fa-secret" readonly
              style="font-family: monospace; background: var(--background-secondary);">
          </div>
          <h4 style="margin: 24px 0 12px;">2단계: 인증 코드 입력</h4>
          <p style="margin-bottom: 16px; color: var(--text-secondary);">
            인증 앱에 표시된 6자리 코드를 입력하여 설정을 완료하세요.
          </p>
          <form id="2fa-verify-form">
            <div class="form-group">
              <label for="2fa-verify-code">인증 코드</label>
              <input type="text" id="2fa-verify-code" placeholder="6자리 코드 입력" maxlength="6" pattern="[0-9]{6}" required
                autocomplete="one-time-code">
            </div>
            <div class="modal-actions">
              <button type="button" class="btn-cancel" id="cancel-2fa-setup">취소</button>
              <button type="submit" class="btn-primary">2FA 활성화</button>
            </div>
          </form>
        </div>
        <div id="2fa-setup-success" style="display: none; text-align: center; padding: 20px;">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none"
            style="color: var(--success); margin: 0 auto 12px;">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
            <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
          <h4 style="margin-bottom: 8px;">2단계 인증이 활성화되었습니다</h4>
          <p style="color: var(--text-secondary); margin-bottom: 20px;">
            이제 로그인 시 인증 코드를 입력해야 합니다.
          </p>
          <button class="btn-primary"
            onclick="document.getElementById('2fa-setup-modal').style.display='none'">확인</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 서버 컨텍스트 메뉴 -->
  <div class="context-menu" id="server-context-menu" style="display: none;">
    <div class="context-menu-item" id="ctx-server-invite">초대하기</div>
    <div class="context-menu-item" id="ctx-server-settings">서버 설정</div>
    <div class="context-menu-divider"></div>
    <div class="context-menu-item danger" id="ctx-server-leave">서버 나가기</div>
  </div>

  <!-- 채널 컨텍스트 메뉴 -->
  <div class="context-menu" id="channel-context-menu" style="display: none;">
    <div class="context-menu-item" id="ctx-channel-edit">채널 편집</div>
    <div class="context-menu-item" id="ctx-channel-mark-read">읽음 처리</div>
    <div class="context-menu-divider"></div>
    <div class="context-menu-item danger" id="ctx-channel-delete">채널 삭제</div>
  </div>

  <!-- Toast 알림 컨테이너 -->
  <div class="toast-container" id="toast-container"></div>

  <script type="module" src="app.js"></script>
</body>

</html>